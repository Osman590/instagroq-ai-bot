.chat{
  flex:1 1 auto;
  padding:16px;

  /* —á—Ç–æ–±—ã —á–∞—Ç –Ω–µ –ø—Ä—è—Ç–∞–ª—Å—è –ø–æ–¥ fixed-top */
  padding-top: calc(60px + env(safe-area-inset-top));

  overflow-y:auto;
  -webkit-overflow-scrolling: touch;
  display:flex;
  flex-direction:column;
  gap:12px;
  min-height:0;
  touch-action: manipulation;
}

/* ============================= */
/* ‚úÖ –ü–õ–ê–í–ù–û–ï –ü–û–Ø–í–õ–ï–ù–ò–ï –°–û–û–ë–©–ï–ù–ò–ô */
/* ============================= */

/* –ø—É–∑—ã—Ä–∏ iPhone vibe */
.msg{
  max-width:78%;
  padding:12px 14px;
  border-radius:18px;
  line-height:1.35;
  font-size:15px;
  font-weight: 580;
  white-space:pre-wrap;
  word-break:break-word;
  box-shadow: 0 10px 26px rgba(0,0,0,.18);

  /* ‚úÖ –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
  opacity: 0;
  transform: translateY(6px) scale(0.98);
  animation: msgIn 0.38s ease-out forwards;
  will-change: transform, opacity;
}

/* ‚úÖ —á—É—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–≤—ã–≥–ª—è–¥–∏—Ç –ø–ª–∞–≤–Ω–µ–µ) */
.msg.bot{ animation-duration: 0.42s; }
.msg.user{ animation-duration: 0.36s; }

@keyframes msgIn{
  to{
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* bot: —Å—Ç–µ–∫–ª—è–Ω–Ω—ã–π */
.bot{
  align-self:flex-start;
  background: rgba(255,255,255,.16);
  border: 1px solid rgba(255,255,255,.18);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

/* user: ‚úÖ –ø–æ —Ç–µ–º–µ (–Ω–µ —Ñ–∏–∫—Å-—Å–∏–Ω–∏–π) */
.user{
  align-self:flex-end;
  background: linear-gradient(
    180deg,
    var(--accent1, #3aa0ff) 0%,
    var(--accent2, #0a84ff) 100%
  );
  border: 1px solid rgba(255,255,255,.10);
}

/* ============================= */
/* ‚úÖ typing bubble (iOS style) */
/* ============================= */

.msg.bot.typing{
  align-self: flex-start;
  margin-bottom: 6px;
  transform: translateY(-4px);

  padding: 6px 10px;
  max-width: 64px;

  background: rgba(255,255,255,.12);
  border: 1px solid rgba(255,255,255,.18);

  border-radius: 16px;

  backdrop-filter: blur(16px) saturate(160%);
  -webkit-backdrop-filter: blur(16px) saturate(160%);

  box-shadow: 0 8px 18px rgba(0,0,0,.18);

  display: inline-flex;
  align-items: center;
  justify-content: center;

  opacity: 1;
  animation: none;
}

/* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–æ—á–µ–∫ */
.typing-dots{
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

/* —Ç–æ—á–∫–∏ */
.typing .dot{
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: rgba(255,255,255,.85);
  box-shadow:
    0 0 0 1px rgba(255,255,255,.25) inset,
    0 8px 18px rgba(0,0,0,.18);

  opacity: .45;
  transform: translateY(0);
  animation: typingPulse 1.1s infinite ease-in-out;
}

.typing .dot:nth-child(2){ animation-delay: .15s; }
.typing .dot:nth-child(3){ animation-delay: .30s; }

@keyframes typingPulse{
  0%, 100% {
    opacity: .40;
    transform: translateY(0) scale(1);
  }
  50% {
    opacity: .95;
    transform: translateY(-2px) scale(1.15);
  }
}

/* ================================================= */
/* ‚úÖ BLACK THEME ‚Äî —Ç—ë–º–Ω–æ-—Å–∏–Ω–∏–µ –ø—É–∑—ã—Ä–∏ –∏ –∫–Ω–æ–ø–∫–∞ send */
/* ================================================= */

:root[data-theme="black"] .msg.user{
  background: linear-gradient(
    180deg,
    #1b2f55 0%,
    #0f1f3d 100%
  );
  border: 1px solid rgba(120,160,255,.25);
  box-shadow:
    0 10px 26px rgba(0,0,0,.55),
    0 0 18px rgba(80,120,255,.18);
}

/* –∫–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ */
:root[data-theme="black"] #sendBtn{
  background: linear-gradient(
    180deg,
    #1e3a6a 0%,
    #102446 100%
  );
  border: 1px solid rgba(120,160,255,.35);
  box-shadow:
    0 6px 18px rgba(0,0,0,.45),
    0 0 14px rgba(90,140,255,.25);
}

/* –∏–∫–æ–Ω–∫–∞ –≤–Ω—É—Ç—Ä–∏ –∫–Ω–æ–ø–∫–∏ (–µ—Å–ª–∏ SVG / —Ç–µ–∫—Å—Ç) */
:root[data-theme="black"] #sendBtn,
:root[data-theme="black"] #sendBtn svg{
  color: #e6efff;
  fill: #e6efff;
}

/* ===================================== */
/* üéõÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò –¶–í–ï–¢–ê –ü–£–ó–´–†–ï–ô –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø */
/* ===================================== */

:root{
  /* –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –≤ –±—É–¥—É—â–µ–º */
  --userBubbleTop: var(--accent1);
  --userBubbleBot: var(--accent2);
  --userBubbleBorder: rgba(255,255,255,.10);
}

/* –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—É–∑—ã—Ä—å */
.user{
  align-self:flex-end;
  background: linear-gradient(
    180deg,
    var(--userBubbleTop) 0%,
    var(--userBubbleBot) 100%
  );
  border: 1px solid var(--userBubbleBorder);
  box-shadow: 0 8px 20px rgba(0,0,0,.35); /* –º—è–≥—á–µ, –±–µ–∑ —Ä–µ–∑–∫–æ–≥–æ —Å–≤–µ—á–µ–Ω–∏—è */
}

/* =============================== */
/* üåë BLACK THEME ‚Äî —Ç–µ–º–Ω–µ–µ –∏ —Å–ø–æ–∫–æ–π–Ω–µ–µ */
/* =============================== */

:root[data-theme="black"]{
  --userBubbleTop:#162744;   /* ‚¨ÖÔ∏è –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å */
  --userBubbleBot:#0d1b33;   /* ‚¨ÖÔ∏è –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å */
  --userBubbleBorder: rgba(120,160,255,.18);
}

/* =============================== */
/* üü£ PURPLE THEME */
/* =============================== */

:root[data-theme="purple"]{
  --userBubbleTop:#3b2466;
  --userBubbleBot:#24143f;
  --userBubbleBorder: rgba(200,160,255,.22);
}

/* =============================== */
/* üü¢ GREEN THEME */
/* =============================== */

:root[data-theme="green"]{
  --userBubbleTop:#1f6a55;
  --userBubbleBot:#124235;
  --userBubbleBorder: rgba(120,220,180,.22);
}

/* =============================== */
/* ‚ö™Ô∏è GRAY THEME */
/* =============================== */

:root[data-theme="gray"]{
  --userBubbleTop:#3a4a63;
  --userBubbleBot:#232f44;
  --userBubbleBorder: rgba(160,190,255,.22);
}