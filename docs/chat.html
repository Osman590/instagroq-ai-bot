<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <title>AI Chat</title>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- ‚úÖ –¢–ï–ú–ê: –ø—Ä–∏–º–µ–Ω—è–µ–º —Å—Ä–∞–∑—É (–±–µ–∑ –º–∏–≥–∞–Ω–∏—è) -->
  <script>
    (function(){
      const KEY = "miniapp_theme_v1";
      function getTheme(){
        const url = new URL(window.location.href);
        const qp = url.searchParams.get("theme");
        if (qp) return qp;
        try{ return localStorage.getItem(KEY) || "blue"; }catch(e){ return "blue"; }
      }
      const theme = getTheme();
      document.documentElement.setAttribute("data-theme", theme);
      try{ localStorage.setItem(KEY, theme); }catch(e){}
    })();
  </script>

  <link rel="stylesheet" href="./css/base.css">
  <link rel="stylesheet" href="./css/panels.css">
  <link rel="stylesheet" href="./css/chat.css?v=3">
</head>

<body>

  <div class="top">
    <a href="./index.html">‚Üê</a>
    <div class="title" id="titleText">AI Chat</div>
    <div class="spacer"></div>
    <button class="gear" id="gearBtn" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">‚öôÔ∏è</button>
  </div>

  <div class="chat" id="chat"></div>

  <div class="input">
    <input id="text"
  placeholder="–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ‚Ä¶"
  autocomplete="on"
  autocapitalize="sentences"
  autocorrect="on"
  spellcheck="true"
/>
    <button id="sendBtn">‚ñ∂</button>
  </div>

  <div class="overlay" id="overlay">
    <div class="sheet">
      <h3 id="settingsTitle">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>

      <div class="row">
        <div id="styleLabel">–°—Ç–∏–ª—å –æ—Ç–≤–µ—Ç–∞</div>
        <select id="styleSel">
          <option value="short" id="optShort">–ö–æ—Ä–æ—Ç–∫–æ</option>
          <option value="steps" id="optSteps">–ü–æ —à–∞–≥–∞–º</option>
          <option value="detail" id="optDetail">–ü–æ–¥—Ä–æ–±–Ω–æ</option>
        </select>
      </div>

      <div class="row">
        <div id="personaLabel">–•–∞—Ä–∞–∫—Ç–µ—Ä</div>
        <select id="personaSel">
          <option value="friendly" id="optFriendly">–û–±—â–∏—Ç–µ–ª—å–Ω—ã–π</option>
          <option value="fun" id="optFun">–í–µ—Å—ë–ª—ã–π</option>
          <option value="strict" id="optStrict">–°—Ç—Ä–æ–≥–∏–π</option>
          <option value="smart" id="optSmart">–£–º–Ω—ã–π</option>
        </select>
      </div>

      <div class="row">
        <div id="chatLabel">–ß–∞—Ç</div>
        <button class="pill" id="clearBtn">üßπ –û—á–∏—Å—Ç–∏—Ç—å</button>
      </div>

      <div class="row">
        <div></div>
        <button class="pill" id="closeSettings">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

  <script type="module" src="./js/chat-page.js"></script>

  <script>
    const STORAGE_LANG = "miniapp_lang_v1";

    function getLang(){
      const url = new URL(window.location.href);
      const qp = url.searchParams.get("lang");
      if (qp) return qp;
      try{ return localStorage.getItem(STORAGE_LANG) || "ru"; }catch(e){ return "ru"; }
    }

    const I18N = {
      ru: {
        title:"AI Chat",
        placeholder:"–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ‚Ä¶",
        settings:"‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏",
        style:"–°—Ç–∏–ª—å –æ—Ç–≤–µ—Ç–∞",
        short:"–ö–æ—Ä–æ—Ç–∫–æ",
        steps:"–ü–æ —à–∞–≥–∞–º",
        detail:"–ü–æ–¥—Ä–æ–±–Ω–æ",
        persona:"–•–∞—Ä–∞–∫—Ç–µ—Ä",
        friendly:"–û–±—â–∏—Ç–µ–ª—å–Ω—ã–π",
        fun:"–í–µ—Å—ë–ª—ã–π",
        strict:"–°—Ç—Ä–æ–≥–∏–π",
        smart:"–£–º–Ω—ã–π",
        chat:"–ß–∞—Ç",
        clear:"üßπ –û—á–∏—Å—Ç–∏—Ç—å",
        close:"–ó–∞–∫—Ä—ã—Ç—å",
      },
      kk: {
        title:"AI —á–∞—Ç",
        placeholder:"–•–∞–±–∞—Ä–ª–∞–º–∞ –∂–∞–∑‚Ä¶",
        settings:"‚öôÔ∏è –ë–∞–ø—Ç–∞—É–ª–∞—Ä",
        style:"–ñ–∞—É–∞–ø —Å—Ç–∏–ª—ñ",
        short:"“ö—ã—Å“õ–∞",
        steps:"“ö–∞–¥–∞–º–º–µ–Ω",
        detail:"–¢–æ–ª—ã“õ",
        persona:"–ú—ñ–Ω–µ–∑",
        friendly:"–î–æ—Å—Ç—ã“õ",
        fun:"–ö”©“£—ñ–ª–¥—ñ",
        strict:"“ö–∞—Ç–∞“£",
        smart:"–ê“õ—ã–ª–¥—ã",
        chat:"–ß–∞—Ç",
        clear:"üßπ –¢–∞–∑–∞–ª–∞—É",
        close:"–ñ–∞–±—É",
      },
      en: {
        title:"AI Chat",
        placeholder:"Type a message‚Ä¶",
        settings:"‚öôÔ∏è Settings",
        style:"Answer style",
        short:"Short",
        steps:"Step-by-step",
        detail:"Detailed",
        persona:"Tone",
        friendly:"Friendly",
        fun:"Fun",
        strict:"Strict",
        smart:"Smart",
        chat:"Chat",
        clear:"üßπ Clear",
        close:"Close",
      },
      tr: {
        title:"Yapay Zek√¢ Sohbet",
        placeholder:"Mesaj yaz‚Ä¶",
        settings:"‚öôÔ∏è Ayarlar",
        style:"Yanƒ±t stili",
        short:"Kƒ±sa",
        steps:"Adƒ±m adƒ±m",
        detail:"Detaylƒ±",
        persona:"√úslup",
        friendly:"Samimi",
        fun:"Eƒülenceli",
        strict:"Katƒ±",
        smart:"Zeki",
        chat:"Sohbet",
        clear:"üßπ Temizle",
        close:"Kapat",
      },
      uz: {
        title:"AI Chat",
        placeholder:"Xabar yoz‚Ä¶",
        settings:"‚öôÔ∏è Sozlamalar",
        style:"Javob uslubi",
        short:"Qisqa",
        steps:"Bosqichma-bosqich",
        detail:"Batafsil",
        persona:"Ohang",
        friendly:"Do‚Äòstona",
        fun:"Quvnoq",
        strict:"Qat‚Äôiy",
        smart:"Aqlli",
        chat:"Chat",
        clear:"üßπ Tozalash",
        close:"Yopish",
      },
      ky: {
        title:"AI —á–∞—Ç",
        placeholder:"–ë–∏–ª–¥–∏—Ä“Ø“Ø –∂–∞–∑‚Ä¶",
        settings:"‚öôÔ∏è –û—Ä–Ω–æ—Ç—É—É–ª–∞—Ä",
        style:"–ñ–æ–æ–ø —Å—Ç–∏–ª–∏",
        short:"–ö—ã—Å–∫–∞",
        steps:"–ö–∞–¥–∞–º-–∫–∞–¥–∞–º",
        detail:"–¢–æ–ª—É–∫",
        persona:"–ú“Ø–Ω”©–∑",
        friendly:"–î–æ—Å—Ç—É–∫",
        fun:"–ö”©“£“Ø–ª–¥“Ø“Ø",
        strict:"–ö–∞—Ç—É—É",
        smart:"–ê–∫—ã–ª–¥—É—É",
        chat:"–ß–∞—Ç",
        clear:"üßπ –¢–∞–∑–∞–ª–æ–æ",
        close:"–ñ–∞–±—É—É",
      },
      uk: {
        title:"AI —á–∞—Ç",
        placeholder:"–ù–∞–ø–∏—à—ñ—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è‚Ä¶",
        settings:"‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
        style:"–°—Ç–∏–ª—å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ",
        short:"–ö–æ—Ä–æ—Ç–∫–æ",
        steps:"–ö—Ä–æ–∫–∞–º–∏",
        detail:"–î–µ—Ç–∞–ª—å–Ω–æ",
        persona:"–¢–æ–Ω",
        friendly:"–î—Ä—É–∂–Ω—ñ–π",
        fun:"–í–µ—Å–µ–ª–∏–π",
        strict:"–°—É–≤–æ—Ä–∏–π",
        smart:"–†–æ–∑—É–º–Ω–∏–π",
        chat:"–ß–∞—Ç",
        clear:"üßπ –û—á–∏—Å—Ç–∏—Ç–∏",
        close:"–ó–∞–∫—Ä–∏—Ç–∏",
      },
      de: {
        title:"KI-Chat",
        placeholder:"Nachricht schreiben‚Ä¶",
        settings:"‚öôÔ∏è Einstellungen",
        style:"Antwortstil",
        short:"Kurz",
        steps:"Schrittweise",
        detail:"Detailliert",
        persona:"Ton",
        friendly:"Freundlich",
        fun:"Locker",
        strict:"Streng",
        smart:"Schlau",
        chat:"Chat",
        clear:"üßπ Leeren",
        close:"Schlie√üen",
      },
      es: {
        title:"Chat IA",
        placeholder:"Escribe un mensaje‚Ä¶",
        settings:"‚öôÔ∏è Ajustes",
        style:"Estilo",
        short:"Corto",
        steps:"Por pasos",
        detail:"Detallado",
        persona:"Tono",
        friendly:"Amable",
        fun:"Divertido",
        strict:"Estricto",
        smart:"Listo",
        chat:"Chat",
        clear:"üßπ Borrar",
        close:"Cerrar",
      },
      fr: {
        title:"Chat IA",
        placeholder:"√âcrire un message‚Ä¶",
        settings:"‚öôÔ∏è R√©glages",
        style:"Style",
        short:"Court",
        steps:"Par √©tapes",
        detail:"D√©taill√©",
        persona:"Ton",
        friendly:"Amical",
        fun:"Dr√¥le",
        strict:"Strict",
        smart:"Malin",
        chat:"Chat",
        clear:"üßπ Effacer",
        close:"Fermer",
      },
    };

    const lang = getLang();
    const t = I18N[lang] || I18N.ru;

    document.getElementById("titleText").textContent = t.title;
    const input = document.getElementById("text");
    if (input) input.placeholder = t.placeholder;

    document.getElementById("settingsTitle").textContent = t.settings;
    document.getElementById("styleLabel").textContent = t.style;
    document.getElementById("optShort").textContent = t.short;
    document.getElementById("optSteps").textContent = t.steps;
    document.getElementById("optDetail").textContent = t.detail;

    document.getElementById("personaLabel").textContent = t.persona;
    document.getElementById("optFriendly").textContent = t.friendly;
    document.getElementById("optFun").textContent = t.fun;
    document.getElementById("optStrict").textContent = t.strict;
    document.getElementById("optSmart").textContent = t.smart;

    document.getElementById("chatLabel").textContent = t.chat;
    document.getElementById("clearBtn").textContent = t.clear;
    document.getElementById("closeSettings").textContent = t.close;

    try{ localStorage.setItem(STORAGE_LANG, lang); }catch(e){}
  </script>
</body>
</html>