<!-- docs/index.html -->
<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <!-- ✅ FIX MENU: запрет zoom/pinch + запрет double-tap zoom -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <title>InstaGroq AI</title>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- ✅ ТЕМА: применяем сразу (без мигания) -->
  <script>
    (function(){
      const KEY = "miniapp_theme_v1";
      function getTheme(){
        const url = new URL(window.location.href);
        const qp = url.searchParams.get("theme");
        if (qp) return qp;
        try{ return localStorage.getItem(KEY) || "blue"; }catch(e){ return "blue"; }
      }
      document.documentElement.setAttribute("data-theme", getTheme());
    })();
  </script>

  <!-- ✅ FIX MENU: iOS Safari/WEBVIEW жесты (pinch/gesture) -->
  <script>
    (function(){
      // iOS gesture events (some webviews still fire these)
      document.addEventListener("gesturestart", (e) => e.preventDefault(), { passive:false });
      document.addEventListener("gesturechange", (e) => e.preventDefault(), { passive:false });
      document.addEventListener("gestureend", (e) => e.preventDefault(), { passive:false });

      // double-tap zoom prevention
      let lastTouchEnd = 0;
      document.addEventListener("touchend", (e) => {
        const now = Date.now();
        if (now - lastTouchEnd <= 300) e.preventDefault();
        lastTouchEnd = now;
      }, { passive:false });

      document.addEventListener("dblclick", (e) => e.preventDefault(), { passive:false });
    })();
  </script>

  <link rel="stylesheet" href="./css/index.css?v=3">
</head>

<body>
  <!-- ✅ КНОПКА ТЕМЫ (левый верх) -->
  <button class="themePill" id="themeBtn" type="button" aria-haspopup="dialog" aria-expanded="false">
    Цвет: Синий
    <span class="chev">▾</span>
  </button>

  <!-- шары -->
  <div class="orb o1"></div>
  <div class="orb o2"></div>
  <div class="orb o3"></div>
  <div class="orb o4"></div>

  <!-- ✅ МНОГО квадратиков (и все двигаются по-разному) -->
  <div class="cube f1" style="left:8%; top:10%"></div>
  <div class="cube f2" style="left:62%; top:8%; width:100px; height:100px"></div>
  <div class="cube small f3" style="left:78%; top:22%"></div>
  <div class="cube f4" style="left:10%; top:58%; width:160px; height:160px"></div>
  <div class="cube small f5" style="left:74%; top:66%"></div>
  <div class="cube tiny f6" style="left:42%; top:26%"></div>
  <div class="cube tiny f2" style="left:56%; top:78%"></div>

  <div class="cube small f1" style="left:18%; top:28%"></div>
  <div class="cube tiny f3" style="left:30%; top:14%"></div>
  <div class="cube tiny f4" style="left:86%; top:46%"></div>
  <div class="cube small f6" style="left:6%; top:40%"></div>
  <div class="cube f5" style="left:82%; top:56%; width:120px; height:120px"></div>

  <div class="cube tiny f1" style="left:50%; top:12%"></div>
  <div class="cube tiny f2" style="left:92%; top:30%"></div>
  <div class="cube small f4" style="left:58%; top:38%"></div>
  <div class="cube tiny f6" style="left:14%; top:74%"></div>
  <div class="cube small f3" style="left:36%; top:82%"></div>

  <div class="wrap">
    <div class="card">
      <a class="btn" id="chatBtn" href="./chat.html?v=2">Чат с ИИ</a>
      <div class="sub" id="subText">Быстрые ответы • Память • Заметки</div>
      <div class="ver" id="verText">miniapp v2</div>

      <div class="langBlock">
        <div class="langTitle" id="langTitle">Язык интерфейса</div>
        <button class="langPill" id="langBtn" type="button" aria-haspopup="dialog" aria-expanded="false">
          Русский (RU)
          <span class="chev">▾</span>
        </button>
      </div>
    </div>
  </div>

  <div class="langOverlay" id="langOverlay" aria-hidden="true">
    <div class="langSheet" role="dialog" aria-modal="true" aria-label="Language selector">
      <div class="langSheetHeader">
        <div class="langSheetTitle" id="langSheetTitle">Язык</div>
        <button class="langClose" id="langClose" type="button">✕</button>
      </div>
      <div class="langList" id="langList"></div>
    </div>
  </div>

  <!-- ✅ Bottom Sheet Theme -->
  <div class="themeOverlay" id="themeOverlay" aria-hidden="true">
    <div class="themeSheet" role="dialog" aria-modal="true" aria-label="Theme selector">
      <div class="themeSheetHeader">
        <div class="themeSheetTitle" id="themeSheetTitle">Цвет</div>
        <button class="themeClose" id="themeClose" type="button">✕</button>
      </div>
      <div class="themeList" id="themeList"></div>
    </div>
  </div>

  <script type="module" src="./js/index.js?v=3"></script>
</body>
</html>
